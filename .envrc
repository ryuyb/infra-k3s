# direnv configuration
# Run `direnv allow` to enable

# Ansible
export ANSIBLE_CONFIG="${PWD}/ansible/ansible.cfg"
export ANSIBLE_VAULT_PASSWORD_FILE="${PWD}/.vault_pass"

# OpenTofu/Terraform
export TF_VAR_cloudflare_api_token="${CLOUDFLARE_API_TOKEN:-}"
export TF_VAR_cloudflare_account_id="${CLOUDFLARE_ACCOUNT_ID:-}"
export TF_VAR_cloudflare_zone_id="${CLOUDFLARE_ZONE_ID:-}"

# Kubernetes
export KUBECONFIG="${PWD}/kubeconfig.yaml"

# GitOps
export GIT_REPO_URL="${GIT_REPO_URL:-}"

# SOPS
export SOPS_AGE_KEY_FILE="${SOPS_AGE_KEY_FILE:-${PWD}/key.txt}"

# Cloudflare
export CLOUDFLARE_API_TOKEN="${CLOUDFLARE_API_TOKEN:-}"
export CLOUDFLARE_ACCOUNT_ID="${CLOUDFLARE_ACCOUNT_ID:-}"
export CLOUDFLARE_ZONE_ID="${CLOUDFLARE_ZONE_ID:-}"

# ACME / Let's Encrypt
export ACME_EMAIL="${ACME_EMAIL:-}"
export DOMAIN="${DOMAIN:-}"

# Velero / R2 Backup
export VELERO_BUCKET="${VELERO_BUCKET:-}"
export R2_ENDPOINT="${R2_ENDPOINT:-}"

# PostgreSQL
export POSTGRES_PASSWORD="${POSTGRES_PASSWORD:-postgres}"

# pgAdmin4
export PGADMIN_EMAIL="${PGADMIN_EMAIL:-admin@example.com}"

# ArgoCD OIDC Configuration
# Set ARGOCD_OIDC_ENABLED=true to enable OIDC authentication
export ARGOCD_OIDC_ENABLED="${ARGOCD_OIDC_ENABLED:-}"
# OIDC Issuer URL (e.g., https://auth.example.com)
export ARGOCD_OIDC_ISSUER_URL="${ARGOCD_OIDC_ISSUER_URL:-}"
# OIDC Client ID (from ZITADEL)
export ARGOCD_OIDC_CLIENT_ID="${ARGOCD_OIDC_CLIENT_ID:-}"
# OIDC Client Secret (from ZITADEL)
export ARGOCD_OIDC_CLIENT_SECRET="${ARGOCD_OIDC_CLIENT_SECRET:-}"
# OIDC Logout URL
export ARGOCD_OIDC_LOGOUT_URL="${ARGOCD_OIDC_LOGOUT_URL:-}"

# Load local overrides (set actual values here)
if [ -f .envrc.local ]; then
  source .envrc.local
fi
